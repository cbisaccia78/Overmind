{% extends 'base.html' %}
{% block content %}
<section class="page-head">
  <h2>Agents</h2>
  <p class="muted">Define operator profiles, allowed tools, and model configuration.</p>
</section>

<section class="card">
  <h3>Create Agent</h3>
  {% if form_error %}
  <p class="pill pill-bad">{{ form_error }}</p>
  {% endif %}
  <form method="post" action="/agents" class="form-grid">
    <label>Name <input name="name" placeholder="release-manager" value="{{ form_values.name }}" /></label>
    <label>Role <input name="role" value="{{ form_values.role }}" /></label>
    <label>Model (required) <input name="model" placeholder="example: gpt-4.1-mini" value="{{ form_values.model }}" /></label>
    <div class="field-block">
      <span class="field-label">Tools</span>
      <div class="tool-picker" role="group" aria-label="Tools">
        {% for tool in available_tools %}
          <label class="tool-option">
            <input type="checkbox" name="tools" value="{{ tool }}" {% if tool in form_values.tools %}checked{% endif %} />
            <span>{{ tool }}</span>
          </label>
        {% endfor %}
      </div>
    </div>
    <button type="submit" class="button primary">Create Agent</button>
  </form>
</section>

<section class="card">
  <h3>Registered Agents</h3>
  <table class="data-table">
    <thead><tr><th>Name</th><th>Role</th><th>Status</th><th>Version</th><th>Tools</th></tr></thead>
    <tbody>
      {% for agent in agents %}
      <tr>
        <td>{{ agent.name }}</td>
        <td>{{ agent.role }}</td>
        <td><span class="pill {% if agent.status == 'active' %}pill-good{% else %}pill-bad{% endif %}">{{ agent.status }}</span></td>
        <td>{{ agent.version }}</td>
        <td>{{ agent.tools_allowed|join(', ') }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</section>
{% endblock %}
